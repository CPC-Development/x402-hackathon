# CPC Sequencer (Rust)

In-process sequencer that keeps channel state in Postgres and validates EOA signatures
using the X402CheddrPaymentChannel EIP-712 domain.

## Env

- `DATABASE_URL` (default: `postgres://x402:x402@localhost:5432/x402`)
- `CHAIN_ID` (default: `31337`)
- `CHANNEL_MANAGER_ADDRESS` (required for valid signatures)
- `MAX_RECIPIENTS` (default: `30`)
- `PORT` (default: `4001`)

## Endpoints

- `GET /health`
- `POST /channel/seed`
- `GET /channel/:id`
- `POST /pay-in-channel`
- `GET /openapi.json` (generated by utoipa)
- `GET /docs` (Swagger UI)

The sequencer maintains an in-memory replica of channel state and persists every update to Postgres.
Duplicate submissions for the same sequence are treated as idempotent if the signature and timestamp match.

## OpenAPI\n+\n+You can also use the static spec at `x402/docs/sequencer-openapi.yaml` if you want\n+to import it into Postman/Insomnia without running the service.
